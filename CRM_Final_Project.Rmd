---
title: "CRM_Final_Project.Rmd"
author: "Christopher Rei-Mohammed"
date: "5/1/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      warning = FALSE)
```


```{r set_working_directory}
#setwd("Pigment_Cell_Data/")
```
- Set the working directory to pigment cell data to ensure that all files, figures, and tables will be saved in the current project folder unless otherwise specified.

- An error occurs when trying to Knit the R markdown file with the setwd command active so I commented it out. I am not deleting the command because I want to the script to be completely reproducible, in addition to keeping a full record of all of my steps.

```{r load_packages, echo=FALSE}
library(tidyverse)
library(lubridate)
```
- Code breakdown: library(name_of_package_to_load)
- Loaded the tidyverse and lubridate packages from the RStudio library to access data manipulation functions and plotting functions.  


# Loading the Datasets

```{r load_datasets, echo=FALSE}
iridophore_data <- read.csv("Christopher_Rei-Mohammed_Bio_539_(Big_Data_Analysis)_Tidy_Preliminary_Pigment_Cell_Data_for_Coding_iridophore_sheet.csv"
         , header=T, sep=",")

melanophore_data <- read.csv("Christopher_Rei-Mohammed_Bio_539_(Big_Data_Analysis)_Tidy_Preliminary_Pigment_Cell_Data_for_Coding_melanophore_sheet2.csv"
                            , header=T, sep=",")
```
- Code breakdown: name_for_dataframe <- read_csv("name_of_csv_file_to_read", header=T, sep=",") 

- The .csv files were uploaded to the server version of RStudio, then named and loaded as dataframes. The [header=T] is inculded in the read argument in order to tell the R program that the first row of the dataframe(data table) contains the column names of the data.  The [sep=","] is included in the arugment in order to tell R to separate the columns by comma. This is necessary in order to properly separate the columns from each other in the table since in a csv file by default, the columns are separated by commas.


```{r saving_raw_dataframes, echo=FALSE}
write_csv(iridophore_data, path = "Tables_pigment_cells/iridophore_data_raw.csv")
write_csv(melanophore_data, path = "Tables_pigment_cells/melanophore_data_raw.csv")
```
- Code breakdown -> write_csv(name_of_dataframe_to_save, path = "folder_to_save_in/name_of_file.csv")

- Use the write_csv() function to save the dataframes as they are generated.

# Filtering the Data


## Filtering Out NA values

```{r filter_datasets_for_NA_values, echo=FALSE}
iridophore_data_filtered <- iridophore_data %>% 
  filter(!is.na(dorsal_cell_counts)) %>% 
  filter(!is.na(ventral_cell_counts))

melanophore_data_filtered <- melanophore_data %>% 
  filter(!is.na(dorsal_cell_counts))
```
-Code breakdown: name_for_filtered_dataframe <- name_of_dataframe_being_filtered %>% (pipe to) filter(!is.na(name_of_first_column_being_filtered)) %>% filter(!is.na(name_of_second_column_being_filtered))

- After the datasets are loaded it is useful to filter out all of the NA values. For this data NA refers to there was no fish to collect data from, while 0 refers to a fish having zero pigment cells to count. The goal was to perform pigment cell counts on specific sample sizes between the different alx4a lines of fish, but due to a small stock fish population size, resulting in low numbers of embryos, it was difficult to get the minimum sample size required to establish correlations.  However, even with fish numbers below the desired sample size, it is still possible to observe trends in the data in regards to what one might expect to see with larger sample sizes. 

- Had to filter iridophore dataset twice: once for the dorsal_cell_counts column and once for the ventral_cell_counts column. Piped the output of the first filter function to the second filter function. Only dorsal melanophores were counted so that dataset only had to be filtered once.
-Within the filter arguments is the command [!is.na(coulumn_name)]. !is.na is used to fitler out all of the values from the column that are not NA values. The result is that only numeric values are present in columns that were filtered.

- The data in both datasets was recorded in a tidy format so they do not need to be tidied using any of the R programs.  However, there are only 2 real variables that can be plotted against each other given the scope of this data; those variables are fish_number and dorsal/ventral_cell_counts.  

-This data is generated by physical pigment cell counts of live fish. The only goal is to compare pigment cell numbers between the different genetic lines, and between the wild type and mutant phenotypes.  The basic expectation is that alx4a homozygous mutants will have no iridophores, and increased levels of melanophores when compared to the wild type fish.  

- All subsequent data filtering is going to be done using the NA filtered dataframes. 

```{r saving_NA_filtered_dataframes, echo=FALSE}
write_csv(iridophore_data_filtered, path = "Tables_pigment_cells/iridophore_data_filtered.csv")
write_csv(melanophore_data_filtered, path = "Tables_pigment_cells/melanophore_data_filtered.csv")
```
- Code breakdown -> write_csv(name_of_dataframe_to_save, path = "folder_to_save_in/name_of_file.csv")

- It is important to save the filtered dataframes as you generate them.


## Filtering Datasets by Genetic Line

```{r filter_data_by_genetic_line, echo=FALSE}
iridophore_data_filtered_4bp_del <- iridophore_data_filtered %>% 
  filter(alx4a_line == "4bp del")

iridophore_data_filtered_8bp_insert <- iridophore_data_filtered %>% 
  filter(alx4a_line == "8bp insert")

melanophore_data_filtered_4bp_del <- melanophore_data_filtered %>% 
  filter(alx4a_line == "4bp del")

melanophore_data_filtered_8bp_insert <- melanophore_data_filtered %>% 
  filter(alx4a_line == "8bp insert")
```
- Code breakdown: name_for_filtered_dataframe <- name_of_dataframe_being_filtered %>%
filter(name_of_column_being_filtered == "value/string_being_filtered_for)

- The filtered iridophore/melanophore datasets can be filtered again to separate the data based on the genetic line the fish belong to. This is achieved by assigning a name to the new filtered dataframe being created, specifying the name of the dataframe you are going to be filtering, and how you are going to be filtering the dataframe.

- Here the [alx4a_line] column is being filtered for either ["8bp insert"] or ["4bp del"], in both the iridophore & melanophore dataframes. The [==] is used in the argument for the filter function in order to specify that you are filtering the [alx4a_line] column (left of ==) for values that are exactly the same as/equal to whatever is to the right of the double equals sign. This allows you to specify how you want to filter the dataset.

- If you are filtering for something that is not a numeric value you need to put it in "quotes".

- Filtering the dataset this way is useful if you want to analyze the data for the two genetic lines separately, while still being able to analyze both phenotypes for the respective genetic lines together. This allows for direct comparisons to be made between the two phenotypes for a single genetic line. It also creates new opportunities for how the data can be plotted and examined. 


```{r saving_filtered_genetic_line_data, echo=FALSE}
write_csv(iridophore_data_filtered_4bp_del, path = "Tables_pigment_cells/iridophore_data_4bp_del.csv")
write_csv(iridophore_data_filtered_8bp_insert, path = "Tables_pigment_cells/iridophore_data_filtered_8bp_insert.csv")

write_csv(melanophore_data_filtered_4bp_del, path = "Tables_pigment_cells/melanophore_data_filtered_4bp_del.csv")
write_csv(melanophore_data_filtered_8bp_insert, path = "Tables_pigment_cells/melanophore_data_filtered_8bp_insert.csv")
```
- Code breakdown -> write_csv(name_of_dataframe_to_save, path = "folder_to_save_in/name_of_file.csv")
- Saving each filtered dataset. 



## Filtering Datasets by Phenotype

```{r filter_data_by_phenotype, echo=FALSE}
iridophore_data_WT_filtered <- iridophore_data_filtered %>% 
  filter(phenotype == "WT")

iridophore_data_Mut_filtered <- iridophore_data_filtered %>% 
  filter(phenotype == "Mut")

melanophore_data_WT_filtered <- melanophore_data_filtered %>% 
  filter(phenotype == "WT")

melanophore_data_Mut_filtered <- melanophore_data_filtered %>% 
  filter(phenotype == "Mut")
```
- Code breakdown: name_for_filtered_dataframe <- name_of_dataframe_being_filtered %>%
filter(name_of_column_being_filtered == "value/string_being_filtered_for)

- This is yet another way of filtering the data, this time using the [phenotype] column and filtering for either ["WT"] or ["Mut"]. The original NA filtered datasets are still being used for the filtering process. The result is dataframes that contain only the inforamtion for either wild type or mutant phenotypes, allowing for direct comparsions of the a single phenotype between the two genetic lines. 

- For example, if on averae 8bp insert mutants have more melanophores than 4bp del mutants, it would be possible to visualize that by plotting the data for both genetic lines together and comparing the cell counts.  

- It is important to note that the way all of these dataframes have been generated have been by using simple functions because this is exploring the different ways in which the data can be filtered and examined. With a larger dataset, or with a specific goal in mind it would be more efficient to pipe these steps together to produce one desired dataframe that has been filtered in the desired way. Additionally, if the data was not already tidy, it would have been necessary to tidy the data using tidyverse functions such as pivot(wider/longer). 


```{r saving_filtered_phenotype_data, echo=FALSE}
write_csv(iridophore_data_Mut_filtered, path = "Tables_pigment_cells/iridophore_data_Mut_filtered.csv")
write_csv(iridophore_data_WT_filtered, path = "Tables_pigment_cells/iridophore_data_WT_filtered.csv")

write_csv(melanophore_data_Mut_filtered, path = "Tables_pigment_cells/melanophore_data_Mut_filtered.csv")
write_csv(melanophore_data_WT_filtered, path = "Tables_pigment_cells/melanophore_data_WT_filtered.csv")
```
- Code breakdown -> write_csv(name_of_dataframe_to_save, path = "folder_to_save_in/name_of_file.csv")



# Plotting Iridophore Data

## Dorsal Iridophore Plots

```{r dorsal_iridophores_plotted_by_phenotype, echo=FALSE}
ggplot(iridophore_data_filtered, aes(fish_number, dorsal_cell_counts, group=date_iridophore, color = alx4a_line)) + 
  geom_point() + facet_wrap(~phenotype) + 
  labs(x = "Fish Number", y = "Number of Dorsal Iridophores", 
       title = "Alx4a Dorsal Iridophore Counts Grouped by Phenotype") +  
  scale_x_continuous(breaks = seq(from = 2, to = 16, by = 2)) + 
  scale_y_continuous(breaks = seq(from = 0, to = 38, by = 4))

ggsave('Figs_pigment_cells/dorsal_iridophore_counts_grouped_by_phenotype.png')
```
- Code breakdown: ggplot(dataframe_being_plotted, aes(column_being_plotted_on_x_axis, column_being_plotted_ony_axis, group=column_you_are_grouping_the_data_by, color = name_of_column_you_are_coloring_the_data_by)) +
geom_point() + facet_wrap(~create_individual_plots_for_each_value_in_the_specified column) + labs(x = "x-axis label", y = "y-axis label", title = "title of plot") + scale_x_continuous(breaks = seq(from = starting_value, to = end_value, by = increments_between_values)) + scale_y_continuous(breaks = seq(from = starting_value, to = end_value, by = increments_between_values))

- ggplot: used to generate plots
- aes(): used within ggplot arguments to specify aesthetics of the plot; what is being plotted on the axes, how the data is being grouped, colored, etc.
- aes( group= ): use [group=] w/in aes to specify how you want the data to be grouped
- aes( color = ): use [color =] w/in aes to specify what column you want to use to color the data points on the plot -> in this scenario alx4a_line column is being used to color the data -> so there will 4bp del data will be in one color and 8bp insert data will be in another color 
- geom_point(): adding a layer to the plot to have the data plotted as points
- facet_wrap(): function being used to create individual plots for each unique value in the specified column -> in this scenario it is creating individual plots for each value/entry in the phenotype column
- labs(x = "", y = "", title = ""): adding axis labels and a title to the plot
- scale_x_continuous(breaks = seq(from = , to = , by = )): use this to change the X-axis units/increments
- from = : the value you want to start with
- to = : the value you want to end at
- by = : the increments you want between the starting and ending values
- scale_y_continuous: same process, but for the y-axis

- Code2 Breakdown: ggsave('name_of_folder_to_save_plot_in/name_of_plot_being_save.png')

- Created inidividual plots for each phenotype and colored the datapoints (dorsal iridophore counts) by alx4a_line. There are two plots, one for the wild type phenotype and one for the mutant phenotype.  The data for the genetic lines are distinguished by color; 4bp del data is one color across both plots and 8bp insert data is another color. 
- Can directly compare dorsal iridophore counts across genetic lines for a given phenotype with this plot. For both genetic lines the mutant phenotype primarily has zero iridophores, but there is an outlier that has 2 dorsal iridophores in the 8bp insert line.


```{r dorsal_iridophores_plotted_by_genetic_line, echo=FALSE}
ggplot(iridophore_data_filtered, aes(fish_number, dorsal_cell_counts, group=date_iridophore, color = phenotype)) + 
  geom_point() + facet_wrap(~alx4a_line) + 
  labs(x = "Fish Number", y = "Number of Dorsal Iridophores", 
       title = "Alx4a Dorsal Iridophore Counts Grouped by Genetic Line") +  
  scale_x_continuous(breaks = seq(from = 2, to = 16, by = 2)) + 
  scale_y_continuous(breaks = seq(from = 0, to = 38, by = 4))

    #this time created individual plots for each genetic line and colored WT vs. Mut measurements

ggsave('Figs_pigment_cells/dorsal_iridophore_counts_grouped_by_genetic_line.png')
```
- Code breakdown: ggplot(dataframe_being_plotted, aes(column_being_plotted_on_x_axis, column_being_plotted_ony_axis, group=column_you_are_grouping_the_data_by, color = name_of_column_you_are_coloring_the_data_by)) +
geom_point() + facet_wrap(~create_individual_plots_for_each_value_in_the_specified column) + labs(x = "x-axis label", y = "y-axis label", title = "title of plot") + scale_x_continuous(breaks = seq(from = starting_value, to = end_value, by = increments_between_values)) + scale_y_continuous(breaks = seq(from = starting_value, to = end_value, by = increments_between_values))

- Code2 Breakdown: ggsave('name_of_folder_to_save_plot_in/name_of_plot_being_save.png')

- Created individual plots for each genetic line and colored the datapoints (dorsal iridophore counts) by phenotype.  Can see the measurements for each genetic line next to each other, and compare the wild type and mutant phenotypes to each other within a genetic line, or compare the measurements across the two genetic lines to each other.



## Ventral Iridophore Plots

```{r ventral_iridophores_plotted_by_genetic_line, echo=FALSE}
ggplot(iridophore_data_filtered, aes(fish_number, ventral_cell_counts, group=date_iridophore, color = phenotype)) + 
  geom_point() + facet_wrap(~alx4a_line) + 
  labs(x = "Fish Number", y = "Number of Ventral Iridophores", 
       title = "Alx4a Ventral Iridophore Counts Grouped by Genetic Line") +  
  scale_x_continuous(breaks = seq(from = 2, to = 16, by = 2)) + 
  scale_y_continuous(breaks = seq(from = 0, to = 17, by = 2))

ggsave('Figs_pigment_cells/ventral_iridophore_counts_grouped_by_genetic_line.png')
```
- Code breakdown: ggplot(dataframe_being_plotted, aes(column_being_plotted_on_x_axis, column_being_plotted_ony_axis, group=column_you_are_grouping_the_data_by, color = name_of_column_you_are_coloring_the_data_by)) +
geom_point() + facet_wrap(~create_individual_plots_for_each_value_in_the_specified column) + labs(x = "x-axis label", y = "y-axis label", title = "title of plot") + scale_x_continuous(breaks = seq(from = starting_value, to = end_value, by = increments_between_values)) + scale_y_continuous(breaks = seq(from = starting_value, to = end_value, by = increments_between_values))

- Code2 Breakdown: ggsave('name_of_folder_to_save_plot_in/name_of_plot_being_save.png')

 There are two plots, one for the wild type phenotype and one for the mutant phenotype.  The data for the genetic lines are distinguished by color; 4bp del data is one color across both plots and 8bp insert data is another color. 

- Created individual plots for each genetic line and colored the datapoints (ventral iridophore counts) by phenotype.  Can see the measurements for each genetic line next to each other, and compare the wild type and mutant phenotypes to each other within a genetic line, or compare the measurements across the two genetic lines to each other. The data for the phenotypes are distinguished by color; WT data is one color across both plots and Mut data is another color.



```{r ventral_iridophores_plotted_by_phenotype, echo=FALSE}
ggplot(iridophore_data_filtered, aes(fish_number, ventral_cell_counts, group=date_iridophore, color = alx4a_line)) + 
  geom_point() + facet_wrap(~phenotype) + 
  labs(x = "Fish Number", y = "Number of Ventral Iridophores", 
       title = "Alx4a Ventral Iridophore Counts Grouped by Phenotype") +  
  scale_x_continuous(breaks = seq(from = 2, to = 16, by = 2)) + 
  scale_y_continuous(breaks = seq(from = 0, to = 17, by = 2))

ggsave('Figs_pigment_cells/ventral_iridophore_counts_grouped_by_phenotype.png')
```
- Code breakdown: ggplot(dataframe_being_plotted, aes(column_being_plotted_on_x_axis, column_being_plotted_ony_axis, group=column_you_are_grouping_the_data_by, color = name_of_column_you_are_coloring_the_data_by)) +
geom_point() + facet_wrap(~create_individual_plots_for_each_value_in_the_specified column) + labs(x = "x-axis label", y = "y-axis label", title = "title of plot") + scale_x_continuous(breaks = seq(from = starting_value, to = end_value, by = increments_between_values)) + scale_y_continuous(breaks = seq(from = starting_value, to = end_value, by = increments_between_values))

- Code2 Breakdown: ggsave('name_of_folder_to_save_plot_in/name_of_plot_being_save.png')

- Created inidividual plots for each phenotype and colored the datapoints (ventral iridophore counts) by alx4a_line. There are two plots, one for the wild type phenotype and one for the mutant phenotype.  The data for the genetic lines are distinguished by color; 4bp del data is one color across both plots and 8bp insert data is another color. Can directly compare cell counts between the two genetic lines for a given phenotype to each other.  

-[MIGHT DELETE THIS OR TRY TO REWORD IT BETTER]This allows you to see if there are differences in cell numbers between the two genetic lines


# Plotting Melanophore Data


## Dorsal Melanophore Plots

```{r dorsal_melanophores_plotted_by_genetic_line, echo=FALSE}
ggplot(melanophore_data_filtered, aes(fish_number, dorsal_cell_counts, group=date_melanophore, color = phenotype)) + 
  geom_point() + facet_wrap(~alx4a_line) + 
  labs(x = "Fish Number", y = "Number of Dorsal Melanophores", 
       title = "Alx4a Dorsal Melanophore Counts Grouped by Genetic Line") +  
  scale_x_continuous(breaks = seq(from = 1, to = 12, by = 1)) + 
  scale_y_continuous(breaks = seq(from = 40, to = 210, by = 15)) 
  
ggsave('Figs_pigment_cells/dorsal_melanophore_counts_grouped_by_genetic_line.png')
```
- Code breakdown: ggplot(dataframe_being_plotted, aes(column_being_plotted_on_x_axis, column_being_plotted_ony_axis, group=column_you_are_grouping_the_data_by, color = name_of_column_you_are_coloring_the_data_by)) +
geom_point() + facet_wrap(~create_individual_plots_for_each_value_in_the_specified column) + labs(x = "x-axis label", y = "y-axis label", title = "title of plot") + scale_x_continuous(breaks = seq(from = starting_value, to = end_value, by = increments_between_values)) + scale_y_continuous(breaks = seq(from = starting_value, to = end_value, by = increments_between_values))

- Code2 Breakdown: ggsave('name_of_folder_to_save_plot_in/name_of_plot_being_save.png')

- The data is plotted by genetic line and colored by phenotype. In this plot the general trend is that, across both genetic lines, mutants usually have more dorsal melanophores than their wild type siblings.



```{r dorsal_melanophores_plotted_by_phenotype, echo=FALSE}
ggplot(melanophore_data_filtered, aes(fish_number, dorsal_cell_counts, group=date_melanophore, color = alx4a_line)) + 
  geom_point() + facet_wrap(~phenotype) + 
  labs(x = "Fish Number", y = "Number of Dorsal Melanophores", 
       title = "Alx4a Dorsal Melanophore Counts Grouped by Phenotype") +  
  scale_x_continuous(breaks = seq(from = 1, to = 12, by = 1)) + 
  scale_y_continuous(breaks = seq(from = 40, to = 210, by = 15))


ggsave('Figs_pigment_cells/dorsal_melanophore_counts_grouped_by_phenotype.png')
```
- Code breakdown: ggplot(dataframe_being_plotted, aes(column_being_plotted_on_x_axis, column_being_plotted_ony_axis, group=column_you_are_grouping_the_data_by, color = name_of_column_you_are_coloring_the_data_by)) +
geom_point() + facet_wrap(~create_individual_plots_for_each_value_in_the_specified column) + labs(x = "x-axis label", y = "y-axis label", title = "title of plot") + scale_x_continuous(breaks = seq(from = starting_value, to = end_value, by = increments_between_values)) + scale_y_continuous(breaks = seq(from = starting_value, to = end_value, by = increments_between_values))

- Code2 Breakdown: ggsave('name_of_folder_to_save_plot_in/name_of_plot_being_save.png')

-Expanding on the trend observed in the previous plot, can stil se the trend of mutants having more melanophores, but on top of that can now directly compare the relative amount of melanophores between the two genetic lines for a given phenotype. The trend appears to be that 8bp insert fish tend to have more melanophores than the 4bp del fish across both phenotypes. Would need more data to draw a concrete conclusion, but can keep this trend in mind when performing cell counts in the future.  Could also use this as a starting point to investigate other potential differences between the two genetic lines, and how they are different from each other such as potential developmental implications.



### Filtered Genetic Line Melanophore Plots

```{r 8bp_insert_dorsal_melanophore_counts_plotted_by_phenotype, echo=FALSE}
ggplot(melanophore_data_filtered_8bp_insert, aes(fish_number, dorsal_cell_counts, group=date_melanophore, 
                                                 color = date_melanophore)) + 
  geom_point() + facet_wrap(~phenotype) + 
  labs(x = "Fish Number", y = "Number of Dorsal Melanophores", 
       title = "Alx4a 8bp Insert Dorsal Melanophore Counts Grouped by Phenotype") +  
  scale_x_continuous(breaks = seq(from = 1, to = 12, by = 1)) + 
  scale_y_continuous(breaks = seq(from = 40, to = 210, by = 15))

ggsave('Figs_pigment_cells/8bp_insert_dorsal_melanophore_counts_grouped_by_phenotype.png')
```

- Using the 8bp insert filtered dataframe so I am only plotting one genetic line.  Coloring the data points by date in order to allow for comparisons of different generations of fish.  Cannot see any relationships given the small size of the current data, but with more data it will be possible to see all of the different generations of fish on one plot and compare them to each other based on phenotype. 
- While being able to compare the different generations to each other may be useful, it is extremely unlikely that there will any type of relationship between the generations and the pigment cell numbers. Considering that these fish would all be coming from the same genetic line it is unlikely that there would any relationship between the pigment cell numbers and the different generations. 



### Melanophore Plots by Filtered Phenotype

```{r mutant_dorsal_melanophore_counts_plotted_by_genetic_line, echo=FALSE}
ggplot(melanophore_data_Mut_filtered, aes(fish_number, dorsal_cell_counts, group=date_melanophore, color = date_melanophore)) +
  geom_point() + facet_wrap(~alx4a_line) + 
  labs(x = "Fish Number", y = "Number of Dorsal Melanophores", 
       title = "Alx4a Mutant Phenotype Melanophore Counts Grouped by Genetic Line") +  
  scale_x_continuous(breaks = seq(from = 2, to = 12, by = 2)) + 
  scale_y_continuous(breaks = seq(from = 90, to = 210, by = 10))
#the general trend here is that 8bp insert mutants have more melanophores than 4bp del fish mutants
#comparing muts to muts between the genetic lines
#

ggsave('Figs_pigment_cells/mutant_dorsal_melanophore_counts_grouped_by_genetic_line.png')
```

- This plot was constructed using the melanophore data that was fitlered for the mutant phenotype. The data points were colored by date in order to distinguish the data points for each different generation based on the day they were recorded, instead of having all the points be the same color based on their genetic line.  This way you can compare different generations of mutant fish within the same genetic line to each other; in addition to, comparing mutants across the two genetic lines. An observable trend in this plot is that the 8bp insert mutants tend to have more dorsal melanophores than 4bp del mutants. There is not enough data to establish whether or not this is an accurate representation of reality, or if the trend is just a result of the limited data size. I can return to this at a later date, after I have acquired more data, and reexamine this trend to see if it holds true or was just the result of a small dataset.




### Melanophore Plots by Date

```{r 8bp_insert_dorsal_melanophores_plotted_by_date, echo=FALSE}
ggplot(melanophore_data_filtered_8bp_insert, aes(fish_number, dorsal_cell_counts, group=date_melanophore, 
                                                 color = phenotype)) + 
  geom_point() + facet_wrap(~date_melanophore) + 
  labs(x = "Fish Number", y = "Number of Dorsal Melanophores", 
       title = "Alx4a 8bp Insert Dorsal Melanophore Counts Grouped by Date") +  
  scale_x_continuous(breaks = seq(from = 1, to = 12, by = 1)) + 
  scale_y_continuous(breaks = seq(from = 40, to = 210, by = 15))

ggsave('Figs_pigment_cells/8bp_insert_dorsal_melanophore_counts_grouped_by_date.png')
```
- Plotting the alx4a filtered dataset, coloring by phenotype, and facet wrapping by date allow you to make comparisons between the numbers of melanophores present in mutant vs. wild type fish.  The general trend seen in the plot is that the mutant fish have more melanophores than the wild type fish.

- Plotting in this manner allows you to compare the pigment cell counts between the two phenotypes for any given sample group on any given date. With more data the pigment cell numbers can be tracked for athe different sample groups of specific line over time allowing for different groups of fish to be compared to each other in addition to comparing mutant and wild type fish to each other. With more data it would be possible to establish a clear trend between mutant fish and increased levels of melanophores.


```{r 4bp_del_dorsal_melanophores_plotted_by_date, echo=FALSE}
ggplot(melanophore_data_filtered_4bp_del, aes(fish_number, dorsal_cell_counts, group=date_melanophore, 
                                                 color = phenotype)) + 
  geom_point() + facet_wrap(~date_melanophore) + 
  labs(x = "Fish Number", y = "Number of Dorsal Melanophores", 
       title = "Alx4a 4bp Deletion Dorsal Melanophore Counts Grouped by Date") +  
  scale_x_continuous(breaks = seq(from = 1, to = 12, by = 1)) + 
  scale_y_continuous(breaks = seq(from = 60, to = 150, by = 5))

ggsave('Figs_pigment_cells/4bp_deletion_dorsal_melanophore_counts_grouped_by_date.png')
```
- This plot is similar to the 8bp insert graph above, and the same general trend is present where the mutant fish have more melanophores than the wild type fish. 
